# 基于STM32的RTOS内核简单实现
* 在同学的推荐下，看到一篇手写实现基于STM32F4的RTOS帖子，链接为[FreeRTOS 简单内核实现](https://blog.csdn.net/lc_guo/article/details/139676590)。
为了熟悉RTOS内核为Linux打下基础，也为了锻炼自己的动手能力，我决定使用手上一块**正点原子STM32F1精英开发板**复现这个帖子的RTOS代码。

* 这个.md作为记录文件，看看自己能走多远

## 2024/11/3
准备工作：\
&emsp;(1) 一块正点原子的STM32精英开发板，主控是STM32F103ZET6。具体参数见图:![参数图](.\pic\1.png).\
开发板的实际图如下：\
![实物图](.\pic\2.jpg)

* 在进行正式的RTOS书写之前，我需要验证这个开发板是否能够正常下载和运行程序。为此，我需要首先就是下载这个开发板的部分资料，网址如下\
[正点原子精英版资料](http://www.openedv.com/docs/boards/stm32/zdyz_stm32f103_jingyingV2.html);给的百度网盘，这点绝对差评！

### 启动第一个程序
为了验证开发板的基础工能是否正常，我决定第一个程序是点亮开发板上的一个LED来验证.为了方便配置和快速生成代码，我决定学习STM32cube的相关内容，这可以帮助我快速上手，只需要修改相应的管脚信息我就能点亮LED.STM32cube的安装教程附上[安装教程](https://blog.csdn.net/Brendon_Tan/article/details/107685563)。\
接下来开始正式配指STM32CUBE来启动开发板。参考视频教程[正点原子CUBE](https://www.bilibili.com/video/BV1Wp42127Cx?vd_source=9cfe8c96e4fed1941ab35fc34dd2dde3&p=3&spm_id_from=333.788.videopod.episodes)    参考的文字教程是正点原子的STM32精英版资料和[SRM32Cube工程](https://blog.csdn.net/lc_guo/article/details/135071885?spm=1001.2014.3001.5502). \
我的具体操作如下：\
* 安装STM32CUBE 需要在官网注册账号并下载 其次 需要下载JAVA便于顺利安装STM32CUBE
* 接下来，打开STM32CUB。界面如图所示：
![界面](.\pic\3.png)
* 进入下面的界面
![界面](.\pic\6.png) \
下一个界面如图所示 \
![界面](.\pic\7.png) \
* 我们需要依次配置上方的`pinout` `Clock` `Project`三个主菜单和它们的子项目 \

* 首先来配指管脚的相关的工能，因为我们需要是LED点亮，因此，我们需要查看硬件原理图，查阅到我这块开发板是LED0是连接的
`PB5`管脚，且是需要下来输出才行。因此按照配指如图所示 \
![界面](.\pic\8.png) \

* 接下来使能RCC始终了时钟来启动GPIO，配置如下
![界面](.\pic\9.png) 
这里面值得注意的是时钟源的选择，一般会HSE会外挂一个8Mhz的晶振作为时钟源，LSE会外挂一个32Khz
的晶振做时钟源。因此，按图中配指即可，没有时钟源择选`disable` 

* 再设置`sys`项目，该项用于配指DEBUG模式
![界面](.\pic\10.png) 
我们日后若用到再来配指，这里选择图中的选项，则只会用到最少的管脚资源

* 接下来配指STM32的时钟树，如图所示
![界面](.\pic\11.png) 

* 接下里，配指具体的STM32工程的生成文件
![界面](.\pic\12.png)

* 对上一个点的(4)做一个说明，最后下载STM32F1的依赖包，我们可以回到主页面(一开始打开那个界面)，点击如图所示的选项
![界面](.\pic\13.png)
进入之后，选择对应的最新依赖包即可
![界面](.\pic\14.png)

* 最后便可以在指定文件生成代码
![界面](.\pic\15.png)

* 最后下载需要参考正点原子的官方教程，我们使用串口下载，标准的下载步骤是：\
1， 把 B0 接 V3.3 \
2， 保持 B1 接 GND \
3， 按一下复位按键 \
4， 使用上位机软件下载代码 \
5，配指下载工具中的下载时序
![界面](.\pic\16.png)
* 下载验证，完美！
![界面](.\pic\17.jpg)
## 2024/11/4
* 完善昨天的内容编写，昨天只是程序搞定了，文档部分得今天来弄，哈哈。

* 在github上建仓，以后学习学习git，方便快速上传和版本管理

